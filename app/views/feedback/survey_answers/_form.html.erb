<%= bootstrap_form_for([@survey_answer.survey, @survey_answer]) do |f| %>

<% if @survey_answer.errors.any? %>
  <section id="error_explanation">
    <h2><%= t('feedback.message.errorList') %></h2>
    <ul>
      <% @survey_answer.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
      <% end %>
    </ul>
  </section>
<% end %>

<section>
  <div class="typeHeader">
    &nbsp;<%= Feedback::SurveyAnswer.model_name.human %>&nbsp;
  </div>
  <h1><%= @survey_answer.survey.title %></h1>
</section>

<%= f.hidden_field :survey_id %>

<section>
  <% idx = 0 %>
  <%= f.fields_for :answers do |answer_fields| %>
    <% answer = @survey_answer.answers[answer_fields.index] %>
    <% question = answer.question %>

    <% question_label = question.text %>
    <% if !question.is_subquestion %>
      <% idx += 1 %>
      <% question_label = idx.to_s + '.) ' + question_label %>
    <% end %>

    <div class="<%= question.is_subquestion ? 'subquestion' : '' %>">
      <%= answer_fields.hidden_field :question_id %>
      <%= render partial: question.question_type + '_question',
               locals: { f: answer_fields, question: question, answer: answer, question_label: question_label } %>
    </div>
  <% end %>
</section>

<section>
  <%= f.submit t('feedback.action.saveSurveyAnswer'), class:'submit btn btn-default' %>
</section>

<% end %>
