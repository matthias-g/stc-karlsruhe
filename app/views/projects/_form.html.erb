<%= form_for(@project) do |f| %>

    <% if @project.errors.any? %>
        <section id="error_explanation">
          <h2><%= t('project.message.errorList') %></h2>
          <ul>
            <% @project.errors.full_messages.each do |msg| %>
                <li><%= msg %></li>
            <% end %>
          </ul>
        </section>
    <% end %>

    <section class="project-view project-edit-view">
      <h1><%= (isNew ? t('project.label.new') : (t('project.label.edit') % [@project.title])) %></h1>

      <div class="leftCol">

        <div>
          <h3><%= Project.human_attribute_name('individual_tasks') %></h3>
          <%= f.text_area :individual_tasks %>
        </div>
        <div>
          <h3><%= Project.human_attribute_name('requirements') %></h3>
          <%= f.text_area :requirements %>
        </div>
        <div>
          <h3><%= Project.human_attribute_name('material') %></h3>
          <%= f.text_area :material %>
        </div>
        <div>
          <h3><%= Project.human_attribute_name('week') %></h3>
          <%= f.collection_select(:project_week_id, ProjectWeek.all, :id, :title,
                                  {:selected => @project.project_week.id } ) -%>
        </div>
        <div>
          <h3><%= Project.human_attribute_name('days') %></h3>
          <%= f.collection_select(:day_ids, @project.project_week.days, :id, :title,
             {:selected => @project.days.collect {|t| t.id}}, :multiple => true) -%>
        </div>
        <div>
          <h3><%= Project.human_attribute_name('time') %></h3>
          <%= f.text_field :time %>
        </div>
        <div>
          <h3><%= Project.human_attribute_name('location') %></h3>
          <%= f.text_area :location %>
        </div>
        <div>
            <div class="map edit"
                 data-lon="<%= @project.map_longitude %>"
                 data-lat="<%= @project.map_latitude %>"
                 data-zoom="<%= @project.map_zoom %>">
              <div data-lon="<%= @project.longitude %>"
                   data-lat="<%= @project.latitude %>"
                   data-name="<%= @project.title %>">
              </div>
            </div>
            <%= f.text_field :longitude, :type => :hidden %>
            <%= f.text_field :latitude, :type => :hidden %>
            <%= f.text_field :map_longitude, :type => :hidden %>
            <%= f.text_field :map_latitude, :type => :hidden %>
            <%= f.text_field :map_zoom, :type => :hidden %>
        </div>
      </div>

      <div class="rightCol">
        <div>
          <h3> <%= Project.human_attribute_name('desired_team_size') %></h3>
          <%= f.text_field :desired_team_size %>
        </div>

        <% unless isNew %>
            <div>
              <h3><%= Project.human_attribute_name('leaders') %></h3>
              <% @project.leaders.each do |leader| %>
                  <div>
                    <%= leader.full_name %>
                    <%#= link_to '(X)', delete_leader_project_path(@project,
                         :user_id => leader.id), :method => 'delete' %>
                  </div>
              <% end %>
              <%#= @project.leaders.collect { |v| v.first_name }.join(', ') %>
            </div>
            <div>
              <h3><%= Project.human_attribute_name('volunteers') %></h3>
              <% @project.volunteers.each do |volunteer| %>
                  <div>
                    <%= volunteer.full_name %>
                    <%#= link_to '(=> as leader)', add_leader_project_path(@project,
                         :user_id => volunteer.id), :method => 'post' %>
                  </div>
              <% end %>
              <%#= @project.volunteers.collect { |v| v.first_name }.join(', ') %>
            </div>

            <% if current_user.is_admin? %>
                <div class="adminPanel">
                  <h3><%= t('general.label.adminPanel') %></h3>
                  <ul>
                    <li><%= link_to t('project.action.delete'), @project, method: :delete,
                              data: { confirm: t('general.message.confirmDelete') } %></li>
                  </ul>
                </div>
            <% end %>
        <% end %>
      </div>

      <div class="description">
        <div>
          <h3><%= Project.human_attribute_name('title') %></h3>
          <%= f.text_field :title %>
        </div>

        <div>
          <h3><%= t('project.label.uploadImage') %></h3>
          <%= f.file_field :picture %>
        </div>
        <%= image_tag @project.picture_url(:preview) if @project.picture.file %>
        <div>
          <h3><%= Project.human_attribute_name('picture_source') %></h3>
          <%= f.text_field :picture_source %>
          <%= t('project.edit.hint.picture_source') %>
        </div>

        <div>
          <h3><%= Project.human_attribute_name('description') %></h3>
          <%= f.text_area :description %>
        </div>
        <div>
          <h3><%= Project.human_attribute_name('short_description') %></h3>
          Wenn Du dieses Feld ausfüllst, wird es in der Projektliste statt der ausführlichen Beschreibung angezeigt.
          <%= f.text_area :short_description %>
        </div>
      </div>

      <%#= f.text_field :latitude %>
      <%#= f.text_field :longitude %>
    </section>

    <section>
      <%= f.submit t('project.action.save') %>
      <%= link_to t('general.action.show'), @project %> |
      <%= link_to t('project.action.toOverview'), projects_path %>
    </section>

<% end %>